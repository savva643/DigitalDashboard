# Система расположений элементов

## Описание

Система позволяет выбирать предустановленные шаблоны расположения элементов или создавать кастомное расположение с помощью визуального редактора.

---

## Предустановленные шаблоны

### 1. Default Layout (По умолчанию)
**Описание:** Стандартное расположение - 3 элемента по центру (RPM слева, Center Display в центре, Speed справа), Status Bar сверху, Warning Icons снизу.

**Расположение:**
- Status Bar: сверху
- Center Display: по центру
- Left Gauge (RPM): слева от центрального дисплея
- Right Gauge (Speed): справа от центрального дисплея
- Warning Icons: снизу

### 2. Compact Layout (Компактное)
**Описание:** Все элементы расположены ближе друг к другу с уменьшенными отступами.

**Особенности:**
- Отступы между элементами: 10px (вместо 20px)
- Status Bar: уменьшенные отступы (10px)

### 3. Vertical Layout (Вертикальное)
**Описание:** Датчики расположены сверху и снизу от центрального дисплея.

**Расположение:**
- Status Bar: сверху
- Left Gauge (RPM): сверху от центрального дисплея
- Center Display: по центру
- Right Gauge (Speed): снизу от центрального дисплея
- Warning Icons: снизу

### 4. Wide Layout (Широкое)
**Описание:** Датчики расположены по краям экрана, центральный дисплей посередине.

**Расположение:**
- Status Bar: сверху
- Left Gauge (RPM): слева с большим отступом (50px)
- Center Display: по центру
- Right Gauge (Speed): справа с большим отступом (50px)
- Warning Icons: снизу

### 5. Custom (Кастомное)
**Описание:** Визуальный редактор для свободного размещения элементов.

---

## Использование в конструкторе

### Выбор шаблона:

1. Откройте конструктор (кнопка меню ☰)
2. Перейдите на вкладку **"Расположение"**
3. Выберите шаблон из выпадающего списка:
   - Default
   - Compact
   - Vertical
   - Wide
   - Custom

### Кастомное расположение:

1. Выберите **"Custom"** в списке шаблонов
2. Откроется визуальный редактор
3. Перетащите элементы в нужные позиции:
   - **Status Bar** - можно перемещать только по вертикали
   - **Center Display** - можно перемещать свободно
   - **Left Gauge (RPM)** - можно перемещать свободно
   - **Right Gauge (Speed)** - можно перемещать свободно
   - **Warning Icons** - можно перемещать только по вертикали

4. Позиции сохраняются автоматически при отпускании элемента

---

## Структура layoutConfig в JSON

```json
{
  "layoutConfig": {
    "statusBar": {
      "position": "top",
      "anchors": {
        "top": true,
        "left": true,
        "right": true,
        "margins": 15
      },
      "customPosition": {
        "x": 0,
        "y": 0
      }
    },
    "centerDisplay": {
      "position": "center",
      "anchors": {
        "centerIn": "parent"
      },
      "customPosition": {
        "x": 450,
        "y": 130
      }
    },
    "leftGauge": {
      "position": "left",
      "anchors": {
        "verticalCenter": true,
        "right": "centerDisplay",
        "rightMargin": 20
      },
      "customPosition": {
        "x": 100,
        "y": 150
      }
    },
    "rightGauge": {
      "position": "right",
      "anchors": {
        "verticalCenter": true,
        "left": "centerDisplay",
        "leftMargin": 20
      },
      "customPosition": {
        "x": 800,
        "y": 150
      }
    },
    "warningIcons": {
      "position": "bottom",
      "anchors": {
        "bottom": true,
        "horizontalCenter": true
      },
      "customPosition": {
        "x": 0,
        "y": 650
      }
    }
  }
}
```

### Типы anchors:

- `top`, `bottom`, `left`, `right` - привязка к краям родителя (true/false)
- `centerIn` - центрирование относительно родителя ("parent")
- `horizontalCenter` - горизонтальное центрирование (true)
- `verticalCenter` - вертикальное центрирование (true)
- `margins` - отступы (число)
- `leftMargin`, `rightMargin`, `topMargin`, `bottomMargin` - индивидуальные отступы
- Ссылки на другие элементы: `"right": "centerDisplay"` - привязка справа от centerDisplay

### Custom Position:

Используется в режиме Custom для абсолютного позиционирования:
- `x` - координата X
- `y` - координата Y

---

## Применение layoutConfig в Dashboard.qml

Dashboard.qml автоматически применяет layoutConfig при загрузке темы:

1. Проверяет наличие `layoutConfig` в теме
2. Применяет anchors для каждого элемента
3. Если есть `customPosition` - использует абсолютное позиционирование
4. Если layoutConfig отсутствует - использует значения по умолчанию из темы

---

## Рекомендации

1. **Используйте предустановленные шаблоны** для быстрого старта
2. **Кастомное расположение** - для уникальных конфигураций
3. **Сохраняйте темы** после изменения расположения
4. **Тестируйте** расположение на разных разрешениях экрана

---

## Примеры использования

### Пример 1: Изменить расположение на Compact

1. Откройте конструктор
2. Вкладка "Расположение"
3. Выберите "Compact"
4. Нажмите "Сохранить"

### Пример 2: Создать кастомное расположение

1. Откройте конструктор
2. Вкладка "Расположение"
3. Выберите "Custom"
4. Перетащите элементы в нужные позиции
5. Нажмите "Сохранить"

### Пример 3: Вернуть стандартное расположение

1. Откройте конструктор
2. Вкладка "Расположение"
3. Выберите "Default"
4. Нажмите "Сохранить"

---

## Технические детали

- LayoutConfig сохраняется в JSON файле темы
- При загрузке темы layoutConfig применяется автоматически
- Кастомные позиции имеют приоритет над anchors
- Система поддерживает как anchors, так и абсолютное позиционирование

